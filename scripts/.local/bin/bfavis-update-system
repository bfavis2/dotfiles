#!/usr/bin/env bash

CURRENT_DATE=$(date +"%Y%m%d")
BASE_DIR="${DOTFILES_DIR:-$HOME/dotfiles}"
FULL_PATH="$BASE_DIR/package-list/$(hostname)"

if [[ ! -d "$FULL_PATH" ]]; then
  echo "Directory does not exist. Creating: $FULL_PATH"
  mkdir -p "$FULL_PATH"
fi

yay -Syu --needed --noconfirm

echo "Saving package list to: $FULL_PATH with date: $CURRENT_DATE"
pacman -Qe >"$FULL_PATH/$CURRENT_DATE-explicit-packages.txt"
pacman -Q >"$FULL_PATH/$CURRENT_DATE-full-packages.txt"

# TODO: Diff between package updates so I can see what changed
